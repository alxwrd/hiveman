var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function i(t){return document.createTextNode(t)}function d(){return i(" ")}function f(){return i("")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function h(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let m;function b(t){m=t}function $(t){(function(){if(!m)throw new Error("Function called outside component initialization");return m})().$$.after_update.push(t)}const y=[],w=[],v=[],x=[],O=Promise.resolve();let _=!1;function j(t){v.push(t)}function k(t){x.push(t)}let N=!1;const E=new Set;function L(){if(!N){N=!0;do{for(let t=0;t<y.length;t+=1){const e=y[t];b(e),T(e.$$)}for(y.length=0;w.length;)w.pop()();for(let t=0;t<v.length;t+=1){const e=v[t];E.has(e)||(E.add(e),e())}v.length=0}while(y.length);for(;x.length;)x.pop()();_=!1,N=!1,E.clear()}}function T(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const S=new Set;let C;function A(){C={r:0,c:[],p:C}}function V(){C.r||r(C.c),C=C.p}function H(t,e){t&&t.i&&(S.delete(t),t.i(e))}function z(t,e,n,r){if(t&&t.o){if(S.has(t))return;S.add(t),C.c.push(()=>{S.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function I(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function J(t){t&&t.c()}function M(t,n,s){const{fragment:l,on_mount:a,on_destroy:c,after_update:u}=t.$$;l&&l.m(n,s),j(()=>{const n=a.map(e).filter(o);c?c.push(...n):r(n),t.$$.on_mount=[]}),u.forEach(j)}function P(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function B(t,e){-1===t.$$.dirty[0]&&(y.push(t),_||(_=!0,O.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function F(e,o,s,l,a,u,i=[-1]){const d=m;b(e);const f=o.props||{},p=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:i};let h=!1;if(p.ctx=s?s(e,f,(t,n,...r)=>{const o=r.length?r[0]:n;return p.ctx&&a(p.ctx[t],p.ctx[t]=o)&&(p.bound[t]&&p.bound[t](o),h&&B(e,t)),n}):[],p.update(),h=!0,r(p.before_update),p.fragment=!!l&&l(p.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);p.fragment&&p.fragment.l(t),t.forEach(c)}else p.fragment&&p.fragment.c();o.intro&&H(e.$$.fragment),M(e,o.target,o.anchor),L()}b(d)}class U{$destroy(){P(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function q(e){let n,o,s,f,m,b,$,y;return{c(){n=u("div"),o=u("label"),s=i(e[1]),f=d(),m=u("input"),h(o,"class","font-bold text-gray-700 block mb-2"),h(m,"type",e[3]),m.value=e[0],h(m,"class",b="block appearance-none w-full bg-white border border-gray-400\n    hover:border-gray-600 px-2 py-2 rounded shadow outline-none "+(""===e[0]&&e[4]?"border-red-400":"border-gray-400")),h(m,"placeholder",e[2]),h(n,"class","mb-4")},m(t,r){a(t,n,r),l(n,o),l(o,s),l(n,f),l(n,m),$||(y=[p(m,"blur",e[5]),p(m,"input",e[6]),p(m,"change",e[6])],$=!0)},p(t,[e]){2&e&&g(s,t[1]),8&e&&h(m,"type",t[3]),1&e&&m.value!==t[0]&&(m.value=t[0]),17&e&&b!==(b="block appearance-none w-full bg-white border border-gray-400\n    hover:border-gray-600 px-2 py-2 rounded shadow outline-none "+(""===t[0]&&t[4]?"border-red-400":"border-gray-400"))&&h(m,"class",b),4&e&&h(m,"placeholder",t[2])},i:t,o:t,d(t){t&&c(n),$=!1,r(y)}}}function D(t,e,n){let{label:r}=e,{placeholder:o=r}=e,{type:s="text"}=e,{value:l=""}=e,a=!1;return t.$set=t=>{"label"in t&&n(1,r=t.label),"placeholder"in t&&n(2,o=t.placeholder),"type"in t&&n(3,s=t.type),"value"in t&&n(0,l=t.value)},[l,r,o,s,a,()=>{n(4,a=!0)},t=>{n(0,l="checkbox"===t.target.type?t.target.checked:t.target.value)}]}class G extends U{constructor(t){super(),F(this,t,D,q,s,{label:1,placeholder:2,type:3,value:0})}}function W(e){let n;return{c(){n=u("div"),n.innerHTML='<img class="h-full py-2" src="assests/hive.svg" alt="Logo, of a bee hive"> \n  <p class="lg:text-4xl md:text-3xl text-xl px-2 font-bold text-gray-800">Hiveman</p>',h(n,"class","w-full h-full flex justify-center items-center")},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&c(n)}}}class X extends U{constructor(t){super(),F(this,t,null,W,s,{})}}const K=[];const Q=(t,e)=>{let n=JSON.parse(window.localStorage.getItem(t));return n||e},R=(t,e)=>{window.localStorage.setItem(t,JSON.stringify(e))},Y=function(e,n=t){let r;const o=[];function l(t){if(s(e,t)&&(e=t,r)){const t=!K.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),K.push(n,e)}if(t){for(let t=0;t<K.length;t+=2)K[t][0](K[t+1]);K.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(s,a=t){const c=[s,a];return o.push(c),1===o.length&&(r=n(l)||t),s(e),()=>{const t=o.indexOf(c);-1!==t&&o.splice(t,1),0===o.length&&(r(),r=null)}}}}(Q("auth",{}));Y.subscribe(t=>{let e=!1;0===Object.keys(Q("auth",{})).length&&Object.keys(t).length&&(e=!0),R("auth",t),e&&location.reload()});let Z;Y.subscribe(t=>{Z=t});function tt(t,e,n,r){return r=Object.assign(r||{},{"Content-Type":"application/vnd.alertme.zoo-6.1+json",Accept:"application/vnd.alertme.zoo-6.1+json","X-Omnia-Client":"Hive Web Dashboard"}),Object.keys(Z).length&&(r=Object.assign(r,{"X-Omnia-Access-Token":Z.sessionId})),fetch("https://api.prod.bgchprod.info:443/omnia"+t,{method:e,headers:r,body:n}).then(t=>{if(!t.ok&&401===t.status)throw Y.set({}),new Error("Not authorised, check authdetails: "+Y);return t}).then(t=>t.json())}function et(t,e){return tt("/auth/sessions","POST",JSON.stringify({sessions:[{username:t,password:e,caller:"WEB"}]})).then(t=>(Y.set(t.sessions[0]),t))}function nt(){return tt("/nodes","GET").then(t=>t.nodes.filter(t=>["node.class.light.json","node.class.colour.tunable.light.json","node.class.smartplug.json"].some(e=>t.attributes.powerSupply&&t.attributes.nodeType.reportedValue.includes(e))))}function rt(t,e){return tt("/nodes/"+t,"PUT",JSON.stringify({nodes:[{attributes:e}]})).then(t=>t)}function ot(t){return rt(t,{state:{targetValue:"ON"}}).then(t=>t.nodes[0])}function st(t){return rt(t,{state:{targetValue:"OFF"}}).then(t=>t.nodes[0])}var lt=Object.freeze({__proto__:null,request:tt,login:et,nodes:nt,node:function(t){return tt("/nodes/"+t,"GET").then(t=>t)},modify:rt,turnOn:ot,turnOff:st});function at(t){let e,n,r,o,s,i,f,g,m,b,$,y,v,x,O,_;function j(e){t[3].call(null,e)}r=new X({});let N={label:"Username"};function E(e){t[4].call(null,e)}void 0!==t[0]&&(N.value=t[0]),f=new G({props:N}),w.push(()=>I(f,"value",j));let L={label:"Password",type:"password"};return void 0!==t[1]&&(L.value=t[1]),b=new G({props:L}),w.push(()=>I(b,"value",E)),{c(){e=u("div"),n=u("div"),J(r.$$.fragment),o=d(),s=u("div"),i=u("form"),J(f.$$.fragment),m=d(),J(b.$$.fragment),y=d(),v=u("div"),v.innerHTML='<button class="bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-2\n          px-4 rounded">Login</button>',h(n,"class","h-16 sm:h-24 md:h-32 my-4"),h(v,"class","flex items-center justify-between"),h(s,"class","border-yellow-600 p-8 border-t-8 bg-white mb-6 rounded-lg shadow-lg"),h(e,"class","w-10/12 lg:w-8/12 xl:w-5/12")},m(c,u){var d;a(c,e,u),l(e,n),M(r,n,null),l(e,o),l(e,s),l(s,i),M(f,i,null),l(i,m),M(b,i,null),l(i,y),l(i,v),x=!0,O||(_=p(i,"submit",(d=t[2],function(t){return t.preventDefault(),d.call(this,t)})),O=!0)},p(t,[e]){const n={};!g&&1&e&&(g=!0,n.value=t[0],k(()=>g=!1)),f.$set(n);const r={};!$&&2&e&&($=!0,r.value=t[1],k(()=>$=!1)),b.$set(r)},i(t){x||(H(r.$$.fragment,t),H(f.$$.fragment,t),H(b.$$.fragment,t),x=!0)},o(t){z(r.$$.fragment,t),z(f.$$.fragment,t),z(b.$$.fragment,t),x=!1},d(t){t&&c(e),P(r),P(f),P(b),O=!1,_()}}}function ct(t,e,n){let r,o;return[r,o,function(){r&&o?et(r,o):console.error("No login data supplied")},function(t){r=t,n(0,r)},function(t){o=t,n(1,o)}]}class ut extends U{constructor(t){super(),F(this,t,ct,at,s,{})}}function it(t){let e,n,r,o,s,i,f,g,m,b,$,y,w;return s=new X({}),{c(){e=u("header"),n=u("div"),r=d(),o=u("div"),J(s.$$.fragment),i=d(),f=u("div"),g=u("div"),m=u("img"),h(n,"class","w-1/4 md:w-1/6 lg:w-1/12"),h(o,"class","w-1/2"),h(m,"class","h-8 mx-6 absolute right-0 rounded-full shadow-md\n          hover:scale-105 transform transition-transform ease-in-out\n          duration-500"),m.src!==(b="https://www.gravatar.com/avatar/"+t[1]+"?d=identicon")&&h(m,"src",b),h(m,"alt","User avatar"),h(g,"class","py-4"),h(f,"class","w-1/4 md:w-1/6 lg:w-1/12"),h(e,"class","bg-yellow-600 h-16 flex justify-between shadow-md")},m(c,u){a(c,e,u),l(e,n),l(e,r),l(e,o),M(s,o,null),l(e,i),l(e,f),l(f,g),l(g,m),$=!0,y||(w=p(f,"click",t[2]),y=!0)},p(t,e){(!$||2&e&&m.src!==(b="https://www.gravatar.com/avatar/"+t[1]+"?d=identicon"))&&h(m,"src",b)},i(t){$||(H(s.$$.fragment,t),$=!0)},o(t){z(s.$$.fragment,t),$=!1},d(t){t&&c(e),P(s),y=!1,w()}}}function dt(t){let e,n,r=t[0].username&&it(t);return{c(){r&&r.c(),e=f()},m(t,o){r&&r.m(t,o),a(t,e,o),n=!0},p(t,[n]){t[0].username?r?(r.p(t,n),1&n&&H(r,1)):(r=it(t),r.c(),H(r,1),r.m(e.parentNode,e)):r&&(A(),z(r,1,1,()=>{r=null}),V())},i(t){n||(H(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&c(e)}}}function ft(t,e,n){let r={},o="";Y.subscribe(t=>{n(0,r=t),n(1,o=md5(r.username||""))});return[r,o,()=>{Y.set({})}]}class pt extends U{constructor(t){super(),F(this,t,ft,dt,s,{})}}function ht(e){let n,r,o,s,f,m,b,$,y,w,v,x,O,_=e[0].name+"",j=e[0].attributes.state.displayValue+"";return{c(){n=u("div"),r=u("div"),o=u("div"),s=u("button"),s.innerHTML='<i class="fas fa-power-off text-gray-500"></i>',f=d(),m=u("p"),b=i(_),$=d(),y=u("p"),w=i(j),h(s,"class","rounded-lg right-0 top-0 absolute w-10 h-10 border appearance-none"),h(o,"class","relative"),h(m,"class","text-lg py-2 font-medium font-bold text-gray-800"),h(y,"class","text-gray-500"),h(r,"class",""),h(n,"id",v=e[0].id),h(n,"class","w-64 h-48 m-4 p-4 mx-auto rounded border shadow")},m(t,c){a(t,n,c),l(n,r),l(r,o),l(o,s),e[3](s),l(r,f),l(r,m),l(m,b),l(r,$),l(r,y),l(y,w),x||(O=p(s,"click",e[2]),x=!0)},p(t,[e]){1&e&&_!==(_=t[0].name+"")&&g(b,_),1&e&&j!==(j=t[0].attributes.state.displayValue+"")&&g(w,j),1&e&&v!==(v=t[0].id)&&h(n,"id",v)},i:t,o:t,d(t){t&&c(n),e[3](null),x=!1,O()}}}function gt(t,e,n){let r,{node:o}=e,s=!1;return $(()=>{s="ON"===o.attributes.state.displayValue,s?(r.firstChild.classList.add("text-yellow-500"),r.firstChild.classList.remove("text-gray-500")):(r.firstChild.classList.remove("text-yellow-500"),r.firstChild.classList.add("text-gray-500")),r.classList.toggle(s?"shadow-inner":null)}),t.$set=t=>{"node"in t&&n(0,o=t.node)},[o,r,function(){(s?st(o.id):ot(o.id)).then(t=>n(0,o=t))},function(t){w[t?"unshift":"push"](()=>{r=t,n(1,r)})}]}class mt extends U{constructor(t){super(),F(this,t,gt,ht,s,{node:0})}}function bt(t,e,n){const r=t.slice();return r[1]=e[n],r}function $t(t){let e,n;return e=new mt({props:{node:t[1]}}),{c(){J(e.$$.fragment)},m(t,r){M(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.node=t[1]),e.$set(r)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function yt(t){let e,n,r,o;e=new pt({});let s=t[0],l=[];for(let e=0;e<s.length;e+=1)l[e]=$t(bt(t,s,e));const i=t=>z(l[t],1,1,()=>{l[t]=null});return{c(){J(e.$$.fragment),n=d(),r=u("div");for(let t=0;t<l.length;t+=1)l[t].c();h(r,"class","flex flex-wrap")},m(t,s){M(e,t,s),a(t,n,s),a(t,r,s);for(let t=0;t<l.length;t+=1)l[t].m(r,null);o=!0},p(t,[e]){if(1&e){let n;for(s=t[0],n=0;n<s.length;n+=1){const o=bt(t,s,n);l[n]?(l[n].p(o,e),H(l[n],1)):(l[n]=$t(o),l[n].c(),H(l[n],1),l[n].m(r,null))}for(A(),n=s.length;n<l.length;n+=1)i(n);V()}},i(t){if(!o){H(e.$$.fragment,t);for(let t=0;t<s.length;t+=1)H(l[t]);o=!0}},o(t){z(e.$$.fragment,t),l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)z(l[t]);o=!1},d(t){P(e,t),t&&c(n),t&&c(r),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(l,t)}}}function wt(t,e,n){window.api=lt;let r=[];return nt().then(t=>{n(0,r=t)}),[r]}class vt extends U{constructor(t){super(),F(this,t,wt,yt,s,{})}}function xt(t){let e,n;return e=new vt({}),{c(){J(e.$$.fragment)},m(t,r){M(e,t,r),n=!0},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function Ot(t){let e,n,r;return n=new ut({}),{c(){e=u("div"),J(n.$$.fragment),h(e,"class","container mx-auto my-16 xl:my-32 flex justify-center items-center")},m(t,o){a(t,e,o),M(n,e,null),r=!0},i(t){r||(H(n.$$.fragment,t),r=!0)},o(t){z(n.$$.fragment,t),r=!1},d(t){t&&c(e),P(n)}}}function _t(t){let e,n,r,o;const s=[Ot,xt],l=[];function u(t,e){return t[0]?1:0}return e=u(t),n=l[e]=s[e](t),{c(){n.c(),r=f()},m(t,n){l[e].m(t,n),a(t,r,n),o=!0},p(t,[o]){let a=e;e=u(t),e!==a&&(A(),z(l[a],1,1,()=>{l[a]=null}),V(),n=l[e],n||(n=l[e]=s[e](t),n.c()),H(n,1),n.m(r.parentNode,r))},i(t){o||(H(n),o=!0)},o(t){z(n),o=!1},d(t){l[e].d(t),t&&c(r)}}}function jt(t,e,n){let r=!1;Y.subscribe(t=>{n(0,r=!!t.sessionId)});return[r]}return new class extends U{constructor(t){super(),F(this,t,jt,_t,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
